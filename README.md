# Omnichannel CRM System

Omnichannel CRM-—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Å–±–æ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —Å —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–æ–≤ (Telegram) –∏ –æ—Ç–≤–µ—Ç–∞ —Å –æ–¥–Ω–æ–≥–æ WEB-—Å–∞–π—Ç–∞.

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Backend**: Python 3.12+, Django 5.1+, Django REST Framework (DRF)
- **Database**: MySQL 8.0+ (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π)
- **MTProto API**: Hydrogram (–¥–ª—è –ª–∏—á–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤)
- **Bot API**: pyTelegramBotAPI —á–µ—Ä–µ–∑ webhook (–¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –±–æ—Ç–∞)
- **Real-time**: Django Channels (WebSockets) –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **Background Tasks**: Celery + Redis –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
- **Async HTTP**: aiohttp –¥–ª—è –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ª–∏—á–Ω—ã–º–∏ Telegram –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏ —á–µ—Ä–µ–∑ Hydrogram
- ‚úÖ –ü–æ–ª–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è Hydrogram —Å OTP –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –±–æ—Ç–æ–º —á–µ—Ä–µ–∑ –∑–∞—â–∏—â–µ–Ω–Ω—ã–π webhook
- ‚úÖ –ï–¥–∏–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö —á–∞—Ç–æ–≤
- ‚úÖ Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ WebSockets —Å —á–∞–Ω–∫–æ–≤–∞–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ Multi-tenant –ø–æ–¥—Ö–æ–¥: –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –∏–º —á–∞—Ç—ã
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤ (—Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, –¥–æ–∫—É–º–µ–Ω—Ç—ã, –≥–æ–ª–æ—Å–æ–≤—ã–µ)
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—ã—Å–æ–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∑–¥–æ—Ä–æ–≤—å—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ –∑–∞—â–∏—â–µ–Ω–Ω—ã–π API
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π retry –Ω–µ—É–¥–∞—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ Docker Compose –¥–ª—è production deployment

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
omnichannel-crm/
‚îú‚îÄ‚îÄ CRM/                    # –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç Django
‚îÇ   ‚îú‚îÄ‚îÄ settings.py        # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ urls.py            # URL –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ asgi.py            # ASGI –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Channels
‚îÇ   ‚îî‚îÄ‚îÄ celery.py          # Celery –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ crm_app/               # –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ models.py          # –ú–æ–¥–µ–ª–∏ –ë–î (TelegramAccount, Chat, Message, Operator)
‚îÇ   ‚îú‚îÄ‚îÄ views.py           # REST API ViewSets
‚îÇ   ‚îú‚îÄ‚îÄ serializers.py     # DRF Serializers
‚îÇ   ‚îú‚îÄ‚îÄ consumers.py       # WebSocket Consumers (Channels)
‚îÇ   ‚îú‚îÄ‚îÄ tasks.py           # Celery –∑–∞–¥–∞—á–∏
‚îÇ   ‚îú‚îÄ‚îÄ services/          # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ telegram_client_manager.py  # –ú–µ–Ω–µ–¥–∂–µ—Ä Hydrogram –∫–ª–∏–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ message_router.py           # –†–æ—É—Ç–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ routing.py         # WebSocket routing
‚îú‚îÄ‚îÄ docker-compose.yml     # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile             # Docker –æ–±—Ä–∞–∑
‚îî‚îÄ‚îÄ requirements.txt       # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/printnewcode/omnichannel-crm.git
cd omnichannel-crm
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
python -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏
venv\Scripts\activate  # Windows
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `mysqlclient` –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è:
- Linux: `sudo apt-get install default-libmysqlclient-dev`
- macOS: `brew install mysql-client`
- Windows: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `PyMySQL` –≤–º–µ—Å—Ç–æ `mysqlclient`

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–∞:

**–î–ª—è Docker Compose:**
```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —à–∞–±–ª–æ–Ω –∏ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ
cp .env.example .env
```

**–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
```bash
# –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
touch .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏:

```env
# Django Settings
SECRET_KEY=your-secret-key-here-change-this-in-production
DEBUG=True
ALLOWED_HOSTS=localhost,127.0.0.1

# Database Settings (MySQL)
DB_NAME=omnichannel_crm
DB_USER=crm_user
DB_PASSWORD=crm_password
DB_HOST=localhost
DB_PORT=3306
DB_ROOT_PASSWORD=root_password

# Redis Settings
REDIS_HOST=localhost
REDIS_PORT=6379

# Celery Settings
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# CORS Settings (–¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞)
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://127.0.0.1:3000

# Logging
DJANGO_LOG_LEVEL=INFO
```

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Docker Compose:

```bash
docker-compose up -d db redis
```

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `omnichannel_crm` –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å `crm_user` –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `docker-compose.yml`. –°–∫—Ä–∏–ø—Ç `docker/mysql/init.sql` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ª–æ–∫–∞–ª—å–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É MySQL (–±–µ–∑ Docker), —Å–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –≤—Ä—É—á–Ω—É—é:

```bash
mysql -u root -p
```

```sql
CREATE DATABASE omnichannel_crm CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'crm_user'@'localhost' IDENTIFIED BY 'crm_password';
GRANT ALL PRIVILEGES ON omnichannel_crm.* TO 'crm_user'@'localhost';
FLUSH PRIVILEGES;
EXIT;
```

### 6. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

```bash
python manage.py makemigrations
python manage.py migrate
```

### 7. –°–æ–∑–¥–∞–Ω–∏–µ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
python manage.py createsuperuser
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### Docker Compose (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

```bash
# 1. –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (MySQL, Redis, Django, Celery, Daphne)
docker-compose up -d

# 2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
docker-compose exec web python manage.py migrate

# 3. –°–æ–∑–¥–∞–Ω–∏–µ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
docker-compose exec web python manage.py createsuperuser

# 4. –î–æ—Å—Ç—É–ø –∫ Django Admin
# –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä:
# http://localhost:8000/admin/
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –≤—Ö–æ–¥–∞

# 5. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Telegram –∞–∫–∫–∞—É–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É
# –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ —Ä–∞–∑–¥–µ–ª–µ "Django Admin Panel" –Ω–∏–∂–µ

# 5. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f

# 6. –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down
```

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±)

1. **–ó–∞–ø—É—Å–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ Docker**:
```bash
# –ó–∞–ø—É—Å–∫ —Ç–æ–ª—å–∫–æ MySQL –∏ Redis
docker-compose up -d db redis
```

2. **–ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è**:
```bash
# Linux/Mac
source venv/bin/activate
# Windows
venv\Scripts\activate
```

3. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π**:
```bash
python manage.py migrate
```

4. **–°–æ–∑–¥–∞–Ω–∏–µ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**:
```bash
python manage.py createsuperuser
```

5. **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤** (–∫–∞–∂–¥—ã–π –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ):

**Django —Å–µ—Ä–≤–µ—Ä**:
```bash
python manage.py runserver
```

**Celery Worker**:
```bash
celery -A CRM worker --loglevel=info --concurrency=4
```

**Celery Beat**:
```bash
celery -A CRM beat --loglevel=info
```

**Daphne (WebSockets)**:
```bash
daphne -b 0.0.0.0 -p 8001 CRM.asgi:application
```

**Health Monitor** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
```bash
python manage.py start_health_monitor --daemon
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è API

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
curl http://localhost:8000/api/health/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞)
curl -H "Authorization: Token YOUR_ADMIN_TOKEN" http://localhost:8000/api/system/status/
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Telegram –∞–∫–∫–∞—É–Ω—Ç–∞

```bash
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
curl -X POST http://localhost:8000/api/api-token-auth/ \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "password"}'
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤

```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
curl -X POST http://localhost:8000/api/upload/ \
  -H "Authorization: Token YOUR_TOKEN" \
  -F "file=@/path/to/your/file.jpg"
```

### 4. WebSocket —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```javascript
// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket
const ws = new WebSocket('ws://localhost:8001/ws/messages/');

// –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
ws.send(JSON.stringify({
    type: 'ping',
    timestamp: Date.now()
}));
```

### 5. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```bash
# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Å–∏—Å—Ç–µ–º—ã
python test_setup.py

# –ò–ª–∏ –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker-compose exec web python test_setup.py
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç:
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API –∑–¥–æ—Ä–æ–≤—å—è
- ‚úÖ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π)
- ‚úÖ Redis –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- ‚úÖ Celery —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ (—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π)
- ‚úÖ –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API

### 1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

```bash
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
curl -X POST http://localhost:8000/api/api-token-auth/ \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "password"}'
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Telegram –∞–∫–∫–∞—É–Ω—Ç–∞ (–ª–∏—á–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç)

```bash
# –ù–∞—á–∞–ª–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
curl -X POST http://localhost:8000/api/accounts/authenticate/ \
  -H "Authorization: Token YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "phone_number": "+1234567890",
    "api_id": 12345,
    "api_hash": "your_api_hash"
  }'

# –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ OTP
curl -X POST http://localhost:8000/api/accounts/{account_id}/verify_otp/ \
  -H "Authorization: Token YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "otp_code": "12345"
  }'

# –ó–∞–ø—É—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞
curl -X POST http://localhost:8000/api/accounts/{account_id}/start/ \
  -H "Authorization: Token YOUR_TOKEN"
```

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞

```bash
curl -X POST http://localhost:8000/api/accounts/ \
  -H "Authorization: Token YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "My Bot",
    "account_type": "bot",
    "bot_token": "123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11",
    "bot_username": "my_bot",
    "webhook_url": "https://your-bot-url.com/webhook"
  }'
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –±–æ—Ç–∞

–í –≤–∞—à–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –±–æ—Ç–µ (pyTelegramBotAPI) –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ webhook –Ω–∞:

```
https://your-crm-domain.com/api/webhook/bot/?token=BOT_TOKEN
```

–ò–ª–∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Ä—É—á–Ω—É—é:

```python
import requests

update = {
    "update_id": 123456,
    "message": {
        "message_id": 1,
        "from": {"id": 123, "first_name": "User", "username": "user"},
        "chat": {"id": 123, "type": "private"},
        "date": 1234567890,
        "text": "Hello"
    }
}

requests.post(
    "http://localhost:8000/api/webhook/bot/",
    json=update,
    headers={"X-Bot-Token": "BOT_TOKEN"}
)
```

### 5. –ü–æ–ª—É—á–µ–Ω–∏–µ —á–∞—Ç–æ–≤

```bash
curl -X GET http://localhost:8000/api/chats/ \
  -H "Authorization: Token YOUR_TOKEN"
```

### 6. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

```bash
# –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è
curl -X GET http://localhost:8000/api/messages/ \
  -H "Authorization: Token YOUR_TOKEN"

# –°–æ–æ–±—â–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —á–∞—Ç–∞
curl -X GET "http://localhost:8000/api/messages/by_chat/?chat_id=1" \
  -H "Authorization: Token YOUR_TOKEN"
```

### 7. –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞

```bash
# –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ—Ç–≤–µ—Ç–∞
curl -X POST http://localhost:8000/api/messages/{message_id}/reply/ \
  -H "Authorization: Token YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "text": "–û—Ç–≤–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ"
  }'

# –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ —Å –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–º
curl -X POST http://localhost:8000/api/messages/{message_id}/reply/ \
  -H "Authorization: Token YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "text": "–û—Ç–≤–µ—Ç —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º",
    "media_path": "/media/uploads/2024/01/01/image.jpg"
  }'
```

### 8. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤

```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
curl -X POST http://localhost:8000/api/upload/ \
  -H "Authorization: Token YOUR_TOKEN" \
  -F "file=@/path/to/your/file.jpg"

# –û—Ç–≤–µ—Ç –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å file_path –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö
```

### 9. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è (–¥–æ—Å—Ç—É–ø–Ω–æ –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
curl http://localhost:8000/api/health/

# –î–µ—Ç–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã)
curl -H "Authorization: Token YOUR_ADMIN_TOKEN" http://localhost:8000/api/system/status/

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (—Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã)
curl -X POST http://localhost:8000/api/system/control/ \
  -H "Authorization: Token YOUR_ADMIN_TOKEN"
```

## Django Admin Panel

### –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω–∫–µ

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É:**
```bash
docker-compose up -d
```

2. **–°–æ–∑–¥–∞–π—Ç–µ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
```bash
docker-compose exec web python manage.py createsuperuser
```

3. **–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä:**
   - URL: `http://localhost:8000/admin/`
   - –í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ Telegram –∞–∫–∫–∞—É–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É

#### 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–∏—á–Ω–æ–≥–æ Telegram –∞–∫–∫–∞—É–Ω—Ç–∞ (Hydrogram)

**–î–ª—è –ª–∏—á–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –¢–û–õ–¨–ö–û —ç—Ç–∏ –ø–æ–ª—è:**

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Telegram Accounts"** –≤ –∞–¥–º–∏–Ω–∫–µ
2. **–ù–∞–∂–º–∏—Ç–µ "Add Telegram account"**
3. **–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¢–û–õ–¨–ö–û –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:**
   - ‚úÖ **Name**: –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω–æ–µ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ú–æ–π —Ä–∞–±–æ—á–∏–π –∞–∫–∫–∞—É–Ω—Ç")
   - ‚úÖ **Account type**: –í—ã–±–µ—Ä–∏—Ç–µ "–õ–∏—á–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç (Hydrogram)"
   - ‚úÖ **Phone number**: –í–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (+1234567890)
   - ‚úÖ **API ID**: –ü–æ–ª—É—á–∏—Ç–µ –Ω–∞ https://my.telegram.org/
   - ‚úÖ **API Hash**: –ü–æ–ª—É—á–∏—Ç–µ –Ω–∞ https://my.telegram.org/

**üìù –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å API ID –∏ API Hash:**
   1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://my.telegram.org/
   2. –í–æ–π–¥–∏—Ç–µ —Å –ø–æ–º–æ—â—å—é –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
   3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "API development tools"
   4. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ
   5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ "api_id" –∏ "api_hash"

**‚ùå –ù–ï –∑–∞–ø–æ–ª–Ω—è–π—Ç–µ —ç—Ç–∏ –ø–æ–ª—è (–∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):**
   - Session String (–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
   - Status (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—Ç–∞–Ω–µ—Ç "–ê–∫—Ç–∏–≤–µ–Ω")
   - Telegram User ID, First Name, Last Name, Username
   - Bot Token, Bot Username, Webhook URL

4. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∞–∫–∫–∞—É–Ω—Ç**
5. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ API –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏** (—Å–º. —Ä–∞–∑–¥–µ–ª API –Ω–∏–∂–µ)

### üöÄ **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤**

**–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è:** –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ª–∏—á–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ –∞–¥–º–∏–Ω–∫–µ —Å –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ (phone, api_id, api_hash), —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
1. ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å "–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è"
2. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç OTP –∫–æ–¥ –≤ Telegram
3. ‚úÖ –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–≤–æ–¥–∞ –∫–æ–¥–∞

### üéõÔ∏è **–£–ª—É—á—à–µ–Ω–Ω—ã–π Django Admin –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**

**–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- **üîó –ü—Ä—è–º–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è OTP** —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É (—Å—Å—ã–ª–∫–∞ "Verify OTP")
- **üé¨ –ú–∞—Å—Å–æ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è** —Å –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏ (–∑–∞–ø—É—Å—Ç–∏—Ç—å/–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ä–∞–∑—É)
- **üöÄ –ë—ã—Å—Ç—Ä–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** –¥–ª—è –ª–∏—á–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
- **üìä –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è** –æ —Å—Ç–∞—Ç—É—Å–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
1. –°–æ–∑–¥–∞–π—Ç–µ –ª–∏—á–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –≤ –∞–¥–º–∏–Ω–∫–µ —Å phone/api_id/api_hash
2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. –ù–∞–∂–º–∏—Ç–µ "Verify OTP" –≤ —Å–ø–∏—Å–∫–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
4. –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∏–∑ Telegram
5. –ê–∫–∫–∞—É–Ω—Ç —Å—Ç–∞–Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### üìã **–ö—Ä–∞—Ç–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –ø–æ–ª—è–º:**

| –ü–æ–ª–µ | –õ–∏—á–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç (Hydrogram) | –ë–æ—Ç (Bot API) | –ö–æ–≥–¥–∞ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è |
|------|---------------------------|---------------|-------------------|
| **Name** | ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ |
| **Account type** | ‚úÖ "–õ–∏—á–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç (Hydrogram)" | ‚úÖ "–ë–æ—Ç (pyTelegramBotAPI)" | –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ |
| **Phone number** | ‚úÖ –í–∞—à –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ | ‚ùå –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º | –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ |
| **API ID** | ‚úÖ –° my.telegram.org | ‚ùå –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º | –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ |
| **API Hash** | ‚úÖ –° my.telegram.org | ‚ùå –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º | –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ |
| **Bot token** | ‚ùå –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º | ‚úÖ –û—Ç @BotFather | –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ |
| **Bot username** | ‚ùå –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º | ‚úÖ –ë–µ–∑ @ | –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ |
| **Webhook URL** | ‚ùå –û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º | ‚úÖ –î–ª—è webhook | –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ |
| **Session String** | üîê –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ OTP | ‚ùå –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | –ü–æ—Å–ª–µ OTP |
| **Status** | üîÑ –ê–≤—Ç–æ: –°–æ–∑–¥–∞–Ω–∏–µ ‚Üí –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Üí –ê–∫—Ç–∏–≤–µ–Ω | üîÑ –ê–≤—Ç–æ: –ê–∫—Ç–∏–≤–µ–Ω | –ü–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ |
| **Telegram User ID** | üîÑ –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è | üîÑ –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è | –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π |
| **First Name/Last Name** | üîÑ –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è | üîÑ –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è | –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π |

### ‚ö†Ô∏è **–ù–æ–≤—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å**

**–î–ª—è –ª–∏—á–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–±):**
1. ‚úÖ –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –≤ –∞–¥–º–∏–Ω–∫–µ —Å phone/api_id/api_hash
2. ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–Ω–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
3. ‚úÖ –ï—Å–ª–∏ SMS –Ω–µ –ø—Ä–∏—à–µ–ª ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ "üîÑ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–æ"
4. ‚úÖ –ù–∞–∂–º–∏—Ç–µ "Verify OTP" –≤ —Å–ø–∏—Å–∫–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
5. ‚úÖ –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∏–∑ Telegram ‚Üí –∞–∫–∫–∞—É–Ω—Ç –≥–æ—Ç–æ–≤!

**üá∑üá∫ –ü—Ä–æ–±–ª–µ–º—ã —Å SMS –≤ –†–æ—Å—Å–∏–∏:**
- –í –†–æ—Å—Å–∏–∏ SMS —á–∞—Å—Ç–æ –Ω–µ –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∏–∑-–∑–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ —Å–≤—è–∑–∏
- Telegram –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É **"üîÑ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–æ"** –¥–ª—è —Å–º–µ–Ω—ã –º–µ—Ç–æ–¥–∞
- –í–æ–∑–º–æ–∂–Ω—ã–µ –º–µ—Ç–æ–¥—ã: APP (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ), CALL (–∑–≤–æ–Ω–æ–∫), FLASH_CALL (–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π)

**–î–ª—è –±–æ—Ç–æ–≤:**
1. ‚úÖ –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç –≤ –∞–¥–º–∏–Ω–∫–µ —Å bot_token/bot_username/webhook_url
2. ‚úÖ –ë–æ—Ç —Å—Ä–∞–∑—É –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ

**–†—É—á–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):**
```bash
# 1. –ù–∞—á–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
curl -X POST http://localhost:8000/api/accounts/1/authenticate/ \
  -H "Authorization: Token YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"phone_number": "+1234567890", "api_id": YOUR_API_ID, "api_hash": "your_api_hash"}'

# 2. –ï—Å–ª–∏ SMS –Ω–µ –ø—Ä–∏—à–µ–ª –ò–õ–ò –∫–æ–¥ –∏—Å—Ç–µ–∫ - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ –¥—Ä—É–≥–∏–º –º–µ—Ç–æ–¥–æ–º
curl -X POST http://localhost:8000/api/accounts/1/resend_code/ \
  -H "Authorization: Token YOUR_TOKEN"

# 3. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å OTP
curl -X POST http://localhost:8000/api/accounts/1/verify_otp/ \
  -H "Authorization: Token YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"otp_code": "–∫–æ–¥_–∏–∑_telegram"}'

**–ü—Ä–æ—Ü–µ—Å—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:**
1. **–ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é"** - –ø–æ–ª—É—á–∏—Ç–µ –∫–æ–¥ –≤ Telegram
2. **–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥** –≤ –ø–æ–ª–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. **–ê–≤—Ç–æ–º–∞—Ç–∏–∫–∞**: –°–∏—Å—Ç–µ–º–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏—Å—Ç–µ–∫—à–∏–µ –∫–æ–¥—ã –∏ —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. **–õ–∏–º–∏—Ç—ã**: –ü—Ä–∏ —á–∞—Å—Ç—ã—Ö –ø–æ–ø—ã—Ç–∫–∞—Ö Telegram –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –æ–∂–∏–¥–∞–Ω–∏—è
5. **–£–¥–æ–±—Å—Ç–≤–æ**: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —É—á–∞—Å—Ç–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

#### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞ (Bot API)

**–î–ª—è –±–æ—Ç–æ–≤ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –¢–û–õ–¨–ö–û —ç—Ç–∏ –ø–æ–ª—è:**

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Telegram Accounts"** –≤ –∞–¥–º–∏–Ω–∫–µ
2. **–ù–∞–∂–º–∏—Ç–µ "Add Telegram account"**
3. **–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¢–û–õ–¨–ö–û –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:**
   - ‚úÖ **Name**: –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω–æ–µ –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ë–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏")
   - ‚úÖ **Account type**: –í—ã–±–µ—Ä–∏—Ç–µ "–ë–æ—Ç (pyTelegramBotAPI)"
   - ‚úÖ **Bot token**: –¢–æ–∫–µ–Ω –æ—Ç @BotFather
   - ‚úÖ **Bot username**: Username –±–æ—Ç–∞ (–±–µ–∑ @)
   - ‚úÖ **Webhook URL**: `https://your-domain.com/api/webhook/bot/YOUR_BOT_TOKEN`

**‚ùå –ù–ï –∑–∞–ø–æ–ª–Ω—è–π—Ç–µ —ç—Ç–∏ –ø–æ–ª—è (–¥–ª—è –±–æ—Ç–æ–≤ –Ω–µ –Ω—É–∂–Ω—ã):**
   - Phone number, API ID, API Hash, Session String
   - Telegram User ID, First Name, Last Name

**üìù –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –±–æ—Ç–∞:**
   1. –ù–∞–ø–∏—à–∏—Ç–µ @BotFather –≤ Telegram
   2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/newbot`
   3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–æ—Ç–∞
   4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω

4. **–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∞–∫–∫–∞—É–Ω—Ç**

#### 3. –°–æ–∑–¥–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Users"** –≤ –∞–¥–º–∏–Ω–∫–µ
2. **–ù–∞–∂–º–∏—Ç–µ "Add user"**
3. **–°–æ–∑–¥–∞–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è** —Å –ª–æ–≥–∏–Ω–æ–º –∏ –ø–∞—Ä–æ–ª–µ–º
4. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Operators"**
5. **–ù–∞–∂–º–∏—Ç–µ "Add Operator"**
6. **–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**
7. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
   - **Is active**: –û—Ç–º–µ—Ç—å—Ç–µ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
   - **Max chats**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50)
   - **Current chats**: –û—Å—Ç–∞–≤—å—Ç–µ 0 (–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

#### 4. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —á–∞—Ç–æ–≤ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º

1. **–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "Chat assignments"** –≤ –∞–¥–º–∏–Ω–∫–µ
2. **–ù–∞–∂–º–∏—Ç–µ "Add Chat assignment"**
3. **–í—ã–±–µ—Ä–∏—Ç–µ:**
   - **Chat**: –ß–∞—Ç –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è
   - **Operator**: –û–ø–µ—Ä–∞—Ç–æ—Ä–∞
   - **Is active**: –û—Ç–º–µ—Ç—å—Ç–µ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏

#### –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö

–í –∞–¥–º–∏–Ω–∫–µ –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å:
- **Telegram Accounts**: –°—Ç–∞—Ç—É—Å, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **Chats**: –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤, —Ç–∏–ø—ã, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- **Messages**: –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
- **Operators**: –°–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∏ –∏—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- **Chat Assignments**: –ù–∞–∑–Ω–∞—á–µ–Ω–∏—è —á–∞—Ç–æ–≤ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É

- **–ó–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ Start/Stop –≤ —Å–ø–∏—Å–∫–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ —Å—Ç–∞—Ç—É—Å –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
- **–õ–æ–≥–∏**: –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ —á–µ—Ä–µ–∑ Docker logs –∏–ª–∏ —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É

## WebSocket API

–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:

```javascript
const ws = new WebSocket('ws://localhost:8001/ws/messages/');

ws.onmessage = function(event) {
    const data = JSON.parse(event.data);
    console.log('Received:', data);
    
    switch(data.type) {
        case 'new_message':
            // –ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            console.log('New message:', data.message);
            break;
        case 'chat_updated':
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞
            console.log('Chat updated:', data.chat);
            break;
        case 'initial_chats':
            // –ù–∞—á–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤
            console.log('Chats:', data.chats);
            break;
    }
};

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π —á–∞—Ç–∞
ws.send(JSON.stringify({
    type: 'get_chat_messages',
    chat_id: 1
}));

// –û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ
ws.send(JSON.stringify({
    type: 'mark_as_read',
    chat_id: 1
}));
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Telegram Client Manager

`TelegramClientManager` —É–ø—Ä–∞–≤–ª—è–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ Hydrogram –∫–ª–∏–µ–Ω—Ç–∞–º–∏:
- –ü–æ–ª–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Å OTP –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
- –ó–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ –ª–µ—Ç—É
- –û–±—Ä–∞–±–æ—Ç–∫–∞ FloodWait –∏ –æ—à–∏–±–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ session strings –≤ –ë–î
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- –ú–µ–¥–∏–∞ –∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ Hydrogram

### Message Router

`MessageRouter` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á–µ—Ä–µ–∑ –∫–∞–∫–æ–π –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ç–≤–µ—Ç:
- –î–ª—è –ª–∏—á–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤: —á–µ—Ä–µ–∑ Hydrogram –∫–ª–∏–µ–Ω—Ç (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
- –î–ª—è –±–æ—Ç–æ–≤: —á–µ—Ä–µ–∑ Bot API —Å aiohttp
- Retry –ª–æ–≥–∏–∫–∞ —Å exponential backoff
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–æ–≤

### Health Monitor

`HealthMonitor` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã:
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –ë–î
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Telegram –∫–ª–∏–µ–Ω—Ç–æ–≤
- Retry –Ω–µ—É–¥–∞—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- Real-time health —Å—Ç–∞—Ç—É—Å

### Database Optimization

–ú–æ–¥–µ–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è MySQL:
- –ò–Ω–¥–µ–∫—Å—ã –Ω–∞ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–æ–ª—è—Ö
- –°–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- `READ-COMMITTED` isolation level –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è deadlocks
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –±—É—Ñ–µ—Ä–æ–≤
- Connection pooling

### Security & Multi-tenancy

- JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å (admin/operator)
- Multi-tenant –∏–∑–æ–ª—è—Ü–∏—è —á–∞—Ç–æ–≤
- CORS –∑–∞—â–∏—Ç–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –∏ –¥–∞–Ω–Ω—ã—Ö

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –¢–æ–∫–µ–Ω—ã API –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚úÖ CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç SQL –∏–Ω—ä–µ–∫—Ü–∏–π (ORM)
- ‚úÖ CSRF –∑–∞—â–∏—Ç–∞
- ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –≤ –∫–æ–¥–µ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env`

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### Docker Compose Services

- **MySQL 8.0**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –≤—ã—Å–æ–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫
- **Redis 7**: –î–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—á–µ—Ä–µ–¥–µ–π
- **Django Web**: –û—Å–Ω–æ–≤–Ω–æ–π API —Å–µ—Ä–≤–µ—Ä
- **Celery Worker**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞—á
- **Celery Beat**: –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏
- **Daphne**: ASGI —Å–µ—Ä–≤–µ—Ä –¥–ª—è WebSockets
- **Health Monitor**: –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è MySQL

- Buffer pool size: 1GB
- Max connections: 500
- InnoDB log file size: 256MB
- Isolation level: READ-COMMITTED
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ init.sql

### Celery

- Concurrency: 4 worker –ø—Ä–æ—Ü–µ—Å—Å–∞
- Max tasks per child: 1000 (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏)
- Prefetch multiplier: 1 (–ª—É—á—à–∞—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞)
- Acks late –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

### Redis

- Max memory: 512MB
- Eviction policy: allkeys-lru
- Persistence: appendonly yes

### Async Operations

- aiohttp –¥–ª—è Bot API –∑–∞–ø—Ä–æ—Å–æ–≤
- Async Django views –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- Async Telegram client operations

## –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ production

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `DEBUG=False` –≤ `.env`
2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ `ALLOWED_HOSTS`
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ PostgreSQL –∏–ª–∏ MySQL —Å —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ HTTPS (Let's Encrypt)
5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Nginx –∫–∞–∫ reverse proxy
6. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (Sentry, Prometheus)
7. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î

## –õ–∏—Ü–µ–Ω–∑–∏—è

Apache-2.0

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:

```bash
docker-compose exec web python test_setup.py
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üéØ –í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤: 7, –ü—Ä–æ–π–¥–µ–Ω–æ: 7, –ü—Ä–æ–≤–∞–ª–µ–Ω–æ: 0
üéâ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã! –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ.
```

### –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ API:**
```bash
curl http://localhost:8000/api/health/
# –û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: {"status": "healthy", "timestamp": "..." }
```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:**
```bash
curl -X POST http://localhost:8000/api/api-token-auth/ \
  -H "Content-Type: application/json" \
  -d '{"username": "admin", "password": "admin123"}'
```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤:**
```bash
curl -X POST http://localhost:8000/api/upload/ \
  -H "Authorization: Token YOUR_TOKEN" \
  -F "file=@test.jpg"
```

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–î–æ–±–∞–≤—å—Ç–µ Telegram –∞–∫–∫–∞—É–Ω—Ç** —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–ª–∏ API
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook** –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –±–æ—Ç–∞
3. **–°–æ–∑–¥–∞–π—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤** –∏ –Ω–∞–∑–Ω–∞—á—å—Ç–µ –∏–º —á–∞—Ç—ã
4. **–ù–∞—á–Ω–∏—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

- **Hydrogram Session Management**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `client.export_session_string()` –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–µ—Å—Å–∏–π
- **Webhook Security**: –¢–æ–∫–µ–Ω-based –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Ñ–æ—Ä–º–∞—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **Multi-tenant Isolation**: Django permissions + –æ–ø–µ—Ä–∞—Ç–æ—Ä—Å–∫–∏–µ —Ä–æ–ª–∏
- **Real-time Updates**: WebSocket —Å chunked –ø–µ—Ä–µ–¥–∞—á–µ–π –¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–ø–∏—Å–∫–æ–≤
- **Health Monitoring**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **File Upload**: Secure upload —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π —Ç–∏–ø–æ–≤ –∏ —Ä–∞–∑–º–µ—Ä–æ–≤

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **MySQL**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã, READ-COMMITTED isolation
- **Redis**: 512MB –ø–∞–º—è—Ç—å, LRU eviction
- **Celery**: 4 worker'–∞, prefetch=1 –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏
- **Async Operations**: aiohttp –¥–ª—è Bot API, asyncio –¥–ª—è Telegram

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ Token-based authentication
- ‚úÖ CORS configuration
- ‚úÖ File upload validation
- ‚úÖ SQL injection protection (ORM)
- ‚úÖ CSRF protection
- ‚úÖ Operator chat isolation
- ‚úÖ Webhook token validation

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π —Å–æ–∑–¥–∞–π—Ç–µ Issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
